(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{620:function(e,r,n){"use strict";n.d(r,"a",(function(){return f}));var t=n(108),o=n(3),c=(n(18),n(29),n(45),n(46),n(52),n(26),n(71),n(648),n(47),n(72),n(57),n(27),n(328),n(14),n(8),n(15),n(32),n(73),n(31),n(37),n(30),n(132),n(34));function l(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return d(e,a);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,a):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,c=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw c}}}}function d(e,a){(null==a||a>e.length)&&(a=e.length);for(var r=0,n=Array(a);r<a;r++)n[r]=e[r];return n}var f=Object(c.c)("currencies",{state:function(){return{currency:{data:null,bank:null,loading:!1,error:!1},regions:[],locations:[],selectedRegion:null,selectedLocation:[],selectedCurrencyCode:null,filteredCurrencies:[]}},getters:{regionsData:function(e){return e.regions},locationsData:function(e){return e.locations},getFilteredLocations:function(e){if(!e.selectedRegion)return[];var r=e.regions.find((function(r){return r.id===e.selectedRegion}));return r&&r.locations||[]},getFilteredCurrencies:function(e){var r;return e.filteredCurrencies.length>0?e.filteredCurrencies:(null===(r=e.currency)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.bank)||void 0===r?void 0:r.response)||[]}},actions:{getCurrencies:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,t,o,c,l,d,f,v,y,h,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.currency.loading=!0,r.prev=1,e.currency.data={list:[],meta:{},bank:{response:[]}},r.prev=3,r.next=7,e.$axios.get("/api/currencies?populate[0]=image");case 7:d=r.sent,r.next=13;break;case 10:r.prev=10,r.t0=r.catch(3),console.error("Error fetching currencies:",r.t0);case 13:return r.prev=13,r.next=17,e.$axios.get("/api/currencies/daily");case 17:f=r.sent,r.next=23;break;case 20:r.prev=20,r.t1=r.catch(13),console.error("Error fetching daily currencies:",r.t1);case 23:v=null!==(n=null===(t=d.data)||void 0===t?void 0:t.data)&&void 0!==n?n:[],y=null!==(o=null===(c=f.data)||void 0===c?void 0:c.items)&&void 0!==o?o:[],h={},v.forEach((function(e){e.code&&e.currencyCode&&(h[e.code]=e.currencyCode)})),e.currency.data={list:v,meta:(null===(l=d.data)||void 0===l?void 0:l.meta)||{},bank:{response:y.map((function(e,r){var n=h[e.code]||e.code||"";return{id:"".concat(e.code||"","-").concat(r),currencyChar:n,currencyCode:e.code||"",code:e.code||"",sbCourse:e.equival||"0",buyingRate:e.buyingRate||"0",sellingRate:e.sellingRate||"0",image:null,globalUpdateTime:e.datetime||"",datetime:e.datetime||"",cbCode:e.cbCode||"00973",diffRate:e.diffRate||"0"}}))}},y.length>0&&(e.currency.data.meta.global_update_time=y[0].datetime||""),m={},v.length>0&&(v.forEach((function(e){e.code&&(m[e.code]=e.image)})),e.currency.data.bank={response:y.map((function(e,r){return{id:"".concat(e.code||"","-").concat(r),currencyChar:e.currencyCode||"",code:e.code||"",sbCourse:e.equival||"0",buyingRate:e.buyingRate||"0",sellingRate:e.sellingRate||"0",image:m[e.code]||null,globalUpdateTime:e.datetime||"",datetime:e.datetime||"",cbCode:e.cbCode||"00973",diffRate:e.diffRate||"0",color:e.color||"gray",diffBuyingRate:e.diffBuyingRate||"0",colorBuyingRate:e.colorBuyingRate||"gray",diffSellingRate:e.diffSellingRate||"0",colorSellingRate:e.colorSellingRate||"gray"}}))}),r.next=37;break;case 33:r.prev=33,r.t2=r.catch(1),e.currency.error=!0,console.error("Error fetching currencies:",r.t2);case 37:return r.prev=37,e.currency.loading=!1,r.finish(37);case 40:case"end":return r.stop()}}),r,null,[[1,33,37,40],[3,10],[13,20]])})))()},getRegions:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.get("/api/location-regions");case 3:(n=r.sent).data&&Array.isArray(n.data.data)&&(e.regions=n.data.data.map((function(e){return{id:e.id,name:e.attributes.name,latitude:e.attributes.latitude,longitude:e.attributes.longitude,locations:[]}}))),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.error("Error fetching regions:",r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},getLocations:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,0!==e.regions.length){r.next=4;break}return r.next=4,e.getRegions();case 4:return r.next=6,e.$axios.get("/api/region-locations");case 6:(n=r.sent).data&&Array.isArray(n.data)&&(o=Object(t.a)(e.regions),n.data.forEach((function(e){var r=o.findIndex((function(r){return r.id===e.id}));-1!==r&&e.locations&&(o[r].locations=e.locations.map((function(e){return{id:e.code,code:e.code,name:e.name}})).sort((function(a,b){return a.name.localeCompare(b.name)})))})),e.regions=o),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.error("Error fetching locations:",r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},setSelectedRegion:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.selectedRegion=e,r&&(this.selectedLocation=[]),r&&this.filterCurrencies()},setSelectedLocation:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Array.isArray(this.selectedLocation)||(this.selectedLocation=[]),""===e?this.selectedLocation=[]:this.selectedLocation.includes(e)?r||(this.selectedLocation=this.selectedLocation.filter((function(code){return code!==e}))):r?this.selectedLocation=[e]:this.selectedLocation.push(e),this.filterCurrencies()},resetSelectedLocations:function(){this.selectedLocation=[]},setSelectedCurrencyCode:function(e){this.selectedCurrencyCode=e,this.filterCurrencies()},filterCurrencies:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,t,o,c,l,d,f,v;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.selectedRegion||e.selectedLocation.length||e.selectedCurrencyCode){r.next=3;break}return e.filteredCurrencies=(null===(n=e.currency)||void 0===n||null===(n=n.data)||void 0===n||null===(n=n.bank)||void 0===n?void 0:n.response)||[],r.abrupt("return");case 3:if(r.prev=3,!(e.selectedLocation&&e.selectedLocation.length>0)){r.next=15;break}if(!((t=e.selectedLocation.filter((function(code){return code}))).length>0)){r.next=11;break}return r.next=9,e.getDailyCurrenciesByBranch(t,e.selectedCurrencyCode);case 9:r.next=13;break;case 11:console.warn("No valid location codes to filter with"),e.filteredCurrencies=(null===(o=e.currency)||void 0===o||null===(o=o.data)||void 0===o||null===(o=o.bank)||void 0===o?void 0:o.response)||[];case 13:r.next=35;break;case 15:if(!e.selectedRegion){r.next=32;break}if(!((c=e.regions.find((function(r){return r.id===e.selectedRegion})))&&c.locations&&c.locations.length>0)){r.next=28;break}if(!((l=c.locations.map((function(e){return e.code})).filter((function(code){return code}))).length>0)){r.next=24;break}return r.next=22,e.getDailyCurrenciesByBranch(l,e.selectedCurrencyCode);case 22:r.next=26;break;case 24:console.warn("No valid location codes found for region:",e.selectedRegion),e.filteredCurrencies=(null===(d=e.currency)||void 0===d||null===(d=d.data)||void 0===d||null===(d=d.bank)||void 0===d?void 0:d.response)||[];case 26:r.next=30;break;case 28:console.warn("No locations found for region:",e.selectedRegion),e.filteredCurrencies=(null===(f=e.currency)||void 0===f||null===(f=f.data)||void 0===f||null===(f=f.bank)||void 0===f?void 0:f.response)||[];case 30:r.next=35;break;case 32:if(!e.selectedCurrencyCode){r.next=35;break}return r.next=35,e.getDailyCurrenciesByBranch([],e.selectedCurrencyCode);case 35:r.next=41;break;case 37:r.prev=37,r.t0=r.catch(3),console.error("Error during filtering:",r.t0),e.filteredCurrencies=(null===(v=e.currency)||void 0===v||null===(v=v.data)||void 0===v||null===(v=v.bank)||void 0===v?void 0:v.response)||[];case 41:case"end":return r.stop()}}),r,null,[[3,37]])})))()},getDailyCurrenciesByBranch:function(e){var r=arguments,n=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var o,c,d,f,v,y,h,m,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.length>1&&void 0!==r[1]?r[1]:null,n.currency.loading=!0,t.prev=2,0!==((null===(c=n.currency)||void 0===c||null===(c=c.data)||void 0===c||null===(c=c.bank)||void 0===c||null===(c=c.response)||void 0===c?void 0:c.map((function(e){return e.currencyCode})))||[]).length){t.next=7;break}return t.next=7,n.getCurrencies();case 7:return d=new URLSearchParams,Array.isArray(e)?e.forEach((function(code){code&&d.append("cbCodes",code)})):e&&d.append("cbCodes",e),o&&d.append("currencyCode",o),f="/api/currencies/daily?".concat(d.toString()),t.next=13,n.$axios.get(f);case 13:if(v=t.sent,n.filteredCurrencies=[],!(v.data&&v.data.items&&Array.isArray(v.data.items)&&v.data.items.length>0)){t.next=23;break}m={},C={},null!==(y=n.currency)&&void 0!==y&&null!==(y=y.data)&&void 0!==y&&y.list&&n.currency.data.list.forEach((function(e){e.code&&e.currencyCode&&(C[e.code]=e.currencyCode)})),null!==(h=n.currency)&&void 0!==h&&null!==(h=h.data)&&void 0!==h&&null!==(h=h.bank)&&void 0!==h&&h.response&&n.currency.data.bank.response.forEach((function(e){e.image&&(m[e.currencyChar]=e.image,e.currencyCode&&(m[e.currencyCode]=e.image))})),n.filteredCurrencies=v.data.items.map((function(e,r){var t="";if(e.cbCode){var o,c=e.cbCode.toString(),d=l(n.regions);try{for(d.s();!(o=d.n()).done;){var f=o.value;if(f.locations){var v=f.locations.find((function(e){var r;return(null==e||null===(r=e.code)||void 0===r?void 0:r.toString())===c}));if(alert(v.code),v){t=v.name;break}}}}catch(e){d.e(e)}finally{d.f()}}var y=C[e.code]||e.code||"";return{id:"".concat(e.code,"-").concat(r),currencyChar:y,currencyCode:e.code,code:e.code,sbCourse:e.equival||e.sbCourse,buyingRate:e.buyingRate,sellingRate:e.sellingRate,image:m[e.code]||m[y],globalUpdateTime:e.datetime,datetime:e.datetime,cbCode:e.cbCode,branchName:t,diffRate:e.diffRate,color:e.color,diffBuyingRate:e.diffBuyingRate,colorBuyingRate:e.colorBuyingRate,diffSellingRate:e.diffSellingRate,colorSellingRate:e.colorSellingRate}})),t.next=29;break;case 23:if(console.warn("No currency items returned for branch:",e,"and currency:",o),n.filteredCurrencies=[],!(o&&Array.isArray(e)&&e.length>0)){t.next=29;break}return t.next=28,n.getDailyCurrenciesByBranch([],o);case 28:return t.abrupt("return");case 29:t.next=35;break;case 31:t.prev=31,t.t0=t.catch(2),console.error("Error fetching branch currencies:",t.t0),n.filteredCurrencies=[];case 35:return t.prev=35,n.currency.loading=!1,t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[2,31,35,38]])})))()},loadCurrencyRates:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,t,o,c,data,d,f,v,y,h,m,C,R;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.get("/api/currencies?populate[0]=image");case 2:return c=r.sent,data=c.data,d=null!==(n=null==data?void 0:data.data)&&void 0!==n?n:[],r.next=7,e.$axios.get("/api/currencies/daily");case 7:f=r.sent,v=null!==(t=null===(o=f.data)||void 0===o?void 0:o.items)&&void 0!==t?t:[],y=[],h=l(v),r.prev=11,C=regeneratorRuntime.mark((function e(){var r,n,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.value,t=d.find((function(e){return e.code===n.code}))){e.next=4;break}return e.abrupt("return",1);case 4:y.push({image:null===(r=t.image)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.url,code:t.code,currency:t.currencyCode,cb:+n.equival,purchase:+n.buyingRate,purchaseColor:n.colorBuyingRate,sale:+n.sellingRate,saleColor:n.colorSellingRate,date:n.datetime});case 5:case"end":return e.stop()}}),e)})),h.s();case 14:if((m=h.n()).done){r.next=20;break}return r.delegateYield(C(),"t0",16);case 16:if(!r.t0){r.next=18;break}return r.abrupt("continue",18);case 18:r.next=14;break;case 20:r.next=25;break;case 22:r.prev=22,r.t1=r.catch(11),h.e(r.t1);case 25:return r.prev=25,h.f(),r.finish(25);case 28:return R=["840","978","643"],y.sort((function(a,b){var e=R.indexOf(a.code),r=R.indexOf(b.code);return-1===e&&-1===r?0:-1===e?1:-1===r?-1:e-r})),r.abrupt("return",y);case 31:case"end":return r.stop()}}),r,null,[[11,22,25,28]])})))()}}})},648:function(e,r,n){"use strict";var t=n(2),o=n(91).findIndex,c=n(170),l="findIndex",d=!0;l in[]&&Array(1)[l]((function(){d=!1})),t({target:"Array",proto:!0,forced:d},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),c(l)}}]);